(function(){$(function(){var e,t,a,i,n,r,d,o,s,l,c,u,p,v,f,m,h,w,y,g,b,E,C,I,M,T,D,L,x,A,P,S,k,B,R,V,O,N;return l={},N={},g={},r={},y={},M={},h=0,c=new Showdown.converter,I={},e={},b={},O=640/360,V={},d=[],w=!1,T={playerID:"1684512102001",playerKey:"AQ~~%2CAAABTw4lHzE~%2Csr1E9bdX6d4wCdvdlD8QKdNij3uKs2K9",width:$(window).width()/1.5,height:$(window).width()/1.5/O,videoID:"3747000906001"},D='<div style="display:none"></div><object id="myExperience" class="BrightcoveExperience"><param name="bgcolor" value="#FFFFFF" /><param name="width" value="{{width}}" /><param name="height" value="{{height}}" /><param name="playerID" value="{{playerID}}" /><param name="playerKey" value="{{playerKey}}" /><param name="isSlim" value="true" /><param name="autoStart" value="false" /><param name="isVid" value="true" /><param name="isUI" value="true" /><param name="dynamicStreaming" value="true" /><param name="@videoPlayer" value="{{videoID}}"; /><param name="includeAPI" value="true" /><param name="templateLoadHandler" value="onTemplateLoad" /><param name="templateReadyHandler" value="onTemplateReady" /></object>',m=function(){return k(),$(".video-nav ul a.episode li").first().addClass("active"),$(".story-nav ul a.additional-episode li").first().addClass("active"),S(f())},L=function(e){return h+=e,5===h?(x(),m(),h=0):void 0},S=function(e){var t,a;return t={height:e},a=JSON.stringify(t),window.parent.postMessage(a,"*")},f=function(){return $(document).height()},window.onTemplateLoad=function(t){return I=brightcove.api.getExperience(t),e=brightcove.api.modules.APIModules,b=I.getModule(brightcove.api.modules.APIModules.VIDEO_PLAYER)},window.onTemplateReady=function(e){return A($("#myExperience")),b.addEventListener(brightcove.api.events.MediaEvent.BEGIN,E),b.addEventListener(brightcove.api.events.MediaEvent.CHANGE,E),b.addEventListener(brightcove.api.events.MediaEvent.COMPLETE,E),b.addEventListener(brightcove.api.events.MediaEvent.ERROR,E),b.addEventListener(brightcove.api.events.MediaEvent.PLAY,E),b.addEventListener(brightcove.api.events.MediaEvent.STOP,E),S(f())},R=function(e){return console.log("swap started"),b.getCurrentVideo(u)},u=function(e,t){return console.log("swap done"),b.loadVideoByID(V.fields.brightcoveVideoId),$(".videos h1").empty().text(V.fields.episodeTitle),V={}},E=function(e){},A=function(e){var t,a,i,n,r,d,o,s,l,c,u;return l=e,r=l.attr("width"),n=l.attr("height"),u=$(window).width(),d=r/n,w?void(l.attr("src")&&(s=l.attr("src"),o=/width=([\d\.]*).*height=([\d\.]*)/,i=s.replace(o,""),l.attr("src",i))):(c=u/1.6,l.attr("width",c),l.attr("height",c/d),t=u-c,a=t/2,l.css({marginLeft:a,marginRight:a,opacity:1}))},i=function(){var e,t;return t=Handlebars.compile(D),e=t(T),document.getElementById("player").innerHTML=e,brightcove.createExperiences()},B=function(){var e,t;return t=document.createElement("script"),t.src="https://www.youtube.com/iframe_api",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)},window.onYouTubeIframeAPIReady=function(){return M=new YT.Player("storyplayer",{height:"39",width:"64",videoId:"VsbG4pXrhr8",events:{onReady:C},playerVars:{modestbranding:!0,controls:1,showinfo:0,hd:1}})},C=function(e){return P("#storyplayer")},k=function(){return window.addEventListener("resize",function(){return P($("#myExperience")),P($("#storyplayer"))}),$("a.arrow-right").click(function(e){var t,a,i,n,r;return e.preventDefault(),t=$(".composers-wrap"),r=t.find(".slide").length,i=t.find(".active"),a=i.data("order"),r-2>=a?(n=t.find("[data-order="+(a+1)+"]"),i.removeClass("active"),n.addClass("active")):(n=t.find("[data-order=0]"),i.removeClass("active"),n.addClass("active"))}),$("a.arrow-left").click(function(e){var t,a,i,n,r;return e.preventDefault(),t=$(".composers-wrap"),r=t.find(".slide").length,i=t.find(".active"),a=i.data("order"),a>=1?(n=t.find("[data-order="+(a-1)+"]"),i.removeClass("active"),n.addClass("active")):(n=t.find("[data-order="+(r-1)+"]"),i.removeClass("active"),n.addClass("active"))}),$("a.pulldown").click(function(e){return e.preventDefault(),$(this).parent().find("ul").slideToggle(200,function(){return S(f())})}),$("a.episode").click(function(e){return $(this).children("li").hasClass("unreleased")?void 0:R()})},s=function(e,t,a){var i;return i=a[t].fields,e.find("li").hasClass("unreleased")?void $(".videos h1").empty().text(i.episodeTitle):(player1.cueVideoById(i.ytVideoId),$(".videos h1").empty().text(i.episodeTitle))},o=function(e,t){var a;return a=t[e].fields,M.cueVideoById(a.additionalYouTube),$(".stories h1").empty().text(a.additionalVideoTitle),$(".stories p.body").empty().text(a.description),$(".stories p.body").slideDown()},n=function(e,t,a){var i,n,r,d,o,s,l,c,u,p,v;if("main"===a){for(p=[],d=s=0,c=e.length;c>s;d=++s)o=e[d],n=o.fields.episodeNumber,i=new Date,r=new Date(o.fields.datetimeOfLaunch),t.append(moment()<r?"<a class='episode' href data-order="+d+"><li class='unreleased' data-release='"+r+"'>"+n+"</li>":"<a class='episode' href data-order="+d+"><li class='released'>"+n+"</li>"),p.push(t.find("li").each(function(){var e,t,a,i;return i=$(this),i.hasClass("unreleased")?(t=i.text(),a=i.data("release"),e=new Date(a),i.bind("mouseenter",function(){return i.empty().text(moment(a).format("ddd, MMM Do"))}),i.bind("mouseleave",function(){})):void 0}));return p}if("additional"===a){for(v=[],d=l=0,u=e.length;u>l;d=++l)o=e[d],n=o.fields.additionalVideoTitle,v.push(t.append("<a class='additional-episode' href data-order="+d+"><li>"+n+"</li>"));return v}},t=function(e){var t,a,i,n,r,d,o,s,l,u;for(u=[],i=s=0,l=e.length;l>s;i=++s)t=e[i],d=t.fields,r=d.composerName,n=d.image.fields.file.url,o=c.makeHtml(d.bio),a="<div class='slide' data-order='"+i+"'><div class='img-wrap'><a class='arrow-left' href></a><a class='arrow-right' href></a><img src='"+n+"'/></div><h2>"+d.composerName+"</h2><p>"+o+"</p></div>",$(".composers-wrap").append(a),u.push($(".slide").first().addClass("active"));return u},a=function(e){var t,a,i,n,r,d,o,s,l,c;for(c=[],s=0,l=e.length;l>s;s++)n=e[s],d=n.fields,o=d.artistName,a=d.rbmaRadioEmbedCode,t=d.descriptions,i=d.artistImage.fields.file.url,r="<div class='show'><img src='"+i+"'/>"+a+"<p>"+t+"</p></div>",c.push($(".radio").append(r));return c},P=function(e){var t,a,i,n,r,d,o;return I=$(e),o=$(window).width(),d=o/1.6,n=I.attr("width"),i=I.attr("height"),r=n/i,w&&(d=o/1.5),I.attr("width",d),I.attr("height",d/r),t=o-d,a=t/2,I.css({marginLeft:a,display:"block"})},x=function(){return $(".spinner").fadeOut(function(){return $(".spinner").remove()})},p=function(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?w=!0:void 0},v=function(){var e;return e=contentful.createClient({accessToken:"38b8dbaf503a350d5722578c6547caca484511f7c78717736ac8f576832be4b0",space:"s9bc5ah7p1d5"}),e.entries({content_type:"42CpXYSUms44OskS6wUU6I",include:1}).done(function(e){return t(e),L(1)}),e.entries({content_type:"36SuQSSPR6QmWOk8CseMC6",include:1,order:"fields.order"}).done(function(e){return N=e,L(1),n(N,$(".video-nav ul"),"main"),i(),$("a.episode").bind("click",function(e){var t;return e.preventDefault(),$(this).parent().find("li").removeClass("active"),$(this).find("li").addClass("active"),t=$(this).data("order"),V=N[t],$(this).children("li").hasClass("unreleased")?void 0:R()})}),e.entries({content_type:"2YpXtnGW80EEGgCUsSMmCc",include:1}).done(function(e){return L(1),a(e)}),e.entries({content_type:"6fwxAcXrxK4yqyaMUiWwWY",include:1,order:"fields.order"}).done(function(e){return L(1),r=e,n(r,$(".story-nav ul"),"additional"),$("a.additional-episode").bind("click",function(e){var t;return e.preventDefault(),$(this).parent().find("li").removeClass("active"),$(this).find("li").addClass("active"),t=$(this).data("order"),o(t,r)}),B()}),e.entries({content_type:"3JB3iYStpCGYGuu24mEcQK",include:1}).done(function(e){return L(1),$("footer p").empty().text(e[0].fields.body)})},v(),p()})}).call(this);